# Threat and Vulnerability Mapping Report

This report outlines the findings from a manual vulnerability assessment performed on the e-commerce lab environment deployed using Ubuntu, Apache, MySQL, and OpenCart. The objective of this assessment is to identify security weaknesses that could be exploited by an attacker.

---

## 1. Open Ports and Service Exposure

**Commands Executed:**

```bash
sudo ss -tuln
nmap -A localhost
```

**Findings:**

| Port | Protocol | Service | State | Remarks                                 |
| ---- | -------- | ------- | ----- | --------------------------------------- |
| 80   | TCP      | Apache  | Open  | Web server publicly accessible          |
| 3306 | TCP      | MySQL   | Open  | Database exposed, no remote restriction |
| 631  | TCP      | CUPS    | Open  | Unnecessary service in production       |

**Observations:**

* Web server (Apache) and database (MySQL) services are accessible locally.
* Port 631 (CUPS printing service) is exposed but is not required for the current use case.

**Recommendation:**

* Disable or restrict access to unnecessary services like CUPS.
* Consider restricting MySQL to local connections only.

**Screenshots:**

* `screenshots/open_ports.png` – Output of `ss -tuln`
* `screenshots/nmap_scan.png` – Nmap scan results

---

## 2. Default and Weak Credentials

**Test Performed:**

* Attempted to access OpenCart admin panel using default credentials: `admin:admin`
* Attempted to log in to MySQL using `sudo mysql -u root -p` with no password

**Findings:**

* Successfully logged into the OpenCart admin panel using default credentials.
* MySQL allowed root login without requiring a password.

**Observations:**

* The use of default credentials in OpenCart presents a high security risk.
* MySQL root access without password is a critical vulnerability.

**Recommendation:**

* Change all default credentials immediately.
* Set a strong password for the MySQL root user and disable root login if not needed.

**Screenshots:**

* `screenshots/opencart_login_attempt.png` – OpenCart admin login using default credentials
* `screenshots/mysql_root_access.png` – MySQL root access without a password

---

## 3. File and Directory Permissions

**Commands Executed:**

```bash
ls -l /var/www/html
ls -l /var/www/html/system/storage
```

**Findings:**

| Directory                    | Permission | Owner    | Remarks                |
| ---------------------------- | ---------- | -------- | ---------------------- |
| /var/www/html                | 755        | www-data | Correct for web root   |
| /var/www/html/system/storage | 775        | www-data | Writable by web server |

**Observations:**

* Web root files have appropriate permissions.
* The `system/storage` directory is writable, which may pose a risk if file uploads are not properly controlled.

**Recommendation:**

* Restrict permissions to directories that require write access only.
* Implement access controls to prevent arbitrary file overwrites.

**Screenshots:**

* `screenshots/html_permissions.png`
* `screenshots/storage_permissions.png`

---

## 4. PHP Information Disclosure

**Test Performed:**

* Created a file `/var/www/html/phpinfo.php` containing `<?php phpinfo(); ?>`
* Accessed the file from the browser via `http://localhost/phpinfo.php`

**Findings:**

* PHP configuration, version, environment variables, and loaded modules were publicly exposed.
* File was removed after confirmation.

**Observations:**

* This type of information disclosure assists attackers in identifying the server environment and potential weaknesses.

**Recommendation:**

* Avoid keeping such test/debugging files on the production server.
* Always remove or disable unnecessary development endpoints.

**Screenshot:**

* `screenshots/phpinfo_exposure.png`

---

## 5. Missing Security Headers in HTTP Response

**Test Performed:**

* Used browser Developer Tools to inspect HTTP response headers for `http://localhost`

**Findings:**

The following HTTP security headers were missing:

| Header                    | Present |
| ------------------------- | ------- |
| X-Frame-Options           | No      |
| X-XSS-Protection          | No      |
| Content-Security-Policy   | No      |
| Strict-Transport-Security | No      |

**Observations:**

* The absence of these headers may increase the risk of clickjacking, cross-site scripting (XSS), and man-in-the-middle (MITM) attacks.

**Recommendation:**

Add the following lines to the Apache virtual host configuration file:

```apache
Header set X-Frame-Options "DENY"
Header set X-XSS-Protection "1; mode=block"
Header set Content-Security-Policy "default-src 'self'"
Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains"
```

Then enable the `headers` module and restart Apache:

```bash
sudo a2enmod headers
sudo systemctl restart apache2
```
---

## Summary of Identified Risks

| Vulnerability                       | Severity | Impact                           | Recommendation                        |
| ----------------------------------- | -------- | -------------------------------- | ------------------------------------- |
| Default OpenCart credentials        | High     | Full admin access                | Change to strong, unique credentials  |
| MySQL root login without password   | High     | Full database compromise         | Set strong root password              |
| PHP info disclosure                 | Medium   | Server fingerprinting            | Remove phpinfo file                   |
| Missing HTTP security headers       | Medium   | Susceptible to XSS, clickjacking | Implement security headers            |
| Writable storage directory          | Medium   | May allow malicious uploads      | Restrict write access to storage path |
| Unnecessary services exposed (CUPS) | Low      | Increases attack surface         | Disable unneeded services             |

---
